<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Kram Studios</title>
  <meta name="description" content="Kram Studios captures natural, people-focused photography and films — Virginia-based, available nationwide."/>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Your main fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600;700&family=Work+Sans:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Calligraphy font for the quote -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="assets/css/styles.css"/>
</head>

<body>
<div class="nav">
  <div class="container nav-inner">
    <a class="brand" href="index.html">Kram Studios</a>
    <div class="menu">
      <a data-nav href="index.html">Home</a>
      <a data-nav href="portfolio.html">Portfolio</a>
      <a data-nav href="about.html">About</a>
      <a data-nav href="contact.html">Contact</a>
      <a class="disabled" href="#" title="Coming soon">Booking</a>
      <a class="disabled" href="#" title="Coming soon">Testimonials</a>
    </div>
  </div>
</div>

<!-- HOME HERO -->
<section class="home-hero" aria-label="Home hero">
  <div class="hero-stage">
    <div class="hero-carousel" aria-label="Featured photos wheel">
      <div class="hero-wheel" id="heroWheel" tabindex="0"></div>
    </div>

    <!-- Overlay copy (ONLY 3 lines) -->
    <div class="hero-overlay">
      <div class="container">
        <div class="hero-overlay-inner">
          <div class="hero-wordmark">KRAM STUDIOS</div>
          <div class="hero-tag">for the hugs, kisses, smiles &amp; overjoyed tears</div>
          <div class="hero-subline">Photography • Films • Virginia-based, available nationwide</div>
        </div>
      </div>
    </div>
    <a class="action-link secondary" href="#intro-title">Learn More</a>
  </div>
</section>

<!-- INTRO band -->
<section class="home-intro" aria-label="Intro">

  <div class="container">
    <div class="intro-wrap">

      <!-- BIG tagline -->
      <div class="intro-title">
        Cherish Now. Relive Forever.
      </div>

      <!-- Calligraphy quote -->
      <div class="intro-quote">
        When you look back, you don’t just remember what it looked like<br> 
        You remember what it felt like.
      </div>

      <!-- Buttons under text -->
      <div class="intro-actions">
        <a class="action-link" href="contact.html">Contact</a>
        <a class="action-link secondary" href="portfolio.html">Portfolio</a>
      </div>

    </div>
  </div>
</section>

<!-- SHOWCASE -->
<section class="showcase" id="showcase" aria-label="Showcase">
  <div class="container">
    <div class="showcase-head"></div>
  </div>

  <!-- Full-bleed carousel -->
  <div class="showcase-carousel" aria-label="Showcase carousel">
    <button class="showcase-nav prev" type="button" aria-label="Scroll left">‹</button>
    <div class="showcase-track" id="showcaseTrack" aria-label="Showcase photos"></div>
    <button class="showcase-nav next" type="button" aria-label="Scroll right">›</button>
  </div>
</section>

<div class="footer">
  <div class="container">
    <div class="row">
      <div>© <span id="year"></span> Kram Studios</div>
      <div class="muted">Located in VA — shoots anywhere in the US</div>
    </div>
    <div class="row" style="margin-top:10px">
      <div><a href="mailto:smaranam.studio@gmail.com">smaranam.studio@gmail.com</a></div>
      <div><a href="https://www.instagram.com/kram_studios/" target="_blank" rel="noopener">Instagram</a></div>
    </div>
  </div>
</div>

<script>
  document.getElementById('year').textContent = new Date().getFullYear();

  // ----------------------------
  // Showcase: build from featured.txt (ALL items)
  // ----------------------------
  function normalizeLine(s){ return (s || "").trim(); }
  function isCommentOrEmpty(s){ return !s || s.startsWith("#") || s.startsWith("//"); }
  function basename(p){ return (p || "").split("/").pop(); }

  async function readLines(url){
    const res = await fetch(url, { cache: "no-store" });
    if (!res.ok) throw new Error(`Failed to load ${url}: ${res.status}`);
    const txt = await res.text();
    return txt.split(/\r?\n/).map(normalizeLine).filter(s => !isCommentOrEmpty(s));
  }

  function buildBasenameMap(photos){
    const m = new Map();
    photos.forEach(p => {
      if (!p?.src) return;
      m.set(basename(p.src).toLowerCase(), p);
    });
    return m;
  }

  function toPhotoObj(resolved){
    if (!resolved) return null;

    if (typeof resolved === "string"){
      const src = resolved;
      const thumb = src.includes("/gallery/full/")
        ? src.replace("/gallery/full/", "/gallery/thumb/")
        : src;
      return { src, thumb, alt: "Kram Studios" };
    }

    return {
      src: resolved.src,
      thumb: resolved.thumb || resolved.src,
      alt: resolved.alt || "Kram Studios"
    };
  }

  (async function buildShowcaseFromFeatured(){
    const track = document.getElementById('showcaseTrack');
    if (!track) return;

    const prevBtn = document.querySelector('.showcase-nav.prev');
    const nextBtn = document.querySelector('.showcase-nav.next');

    function scrollByAmount(dir){
      const amt = Math.max(360, Math.floor(track.clientWidth * 0.85));
      track.scrollBy({ left: dir * amt, behavior: 'smooth' });
    }
    prevBtn?.addEventListener('click', () => scrollByAmount(-1));
    nextBtn?.addEventListener('click', () => scrollByAmount( 1));

    // drag-to-scroll (desktop)
    let isDown = false, startX = 0, startLeft = 0;
    track.addEventListener('mousedown', (e) => {
      isDown = true;
      startX = e.pageX;
      startLeft = track.scrollLeft;
      track.classList.add('is-dragging');
    });
    window.addEventListener('mouseup', () => {
      isDown = false;
      track.classList.remove('is-dragging');
    });
    window.addEventListener('mousemove', (e) => {
      if (!isDown) return;
      const dx = e.pageX - startX;
      track.scrollLeft = startLeft - dx;
    });

    let gallery;
    try {
      const res = await fetch("gallery.json", { cache: "no-store" });
      gallery = await res.json();
    } catch (e) {
      console.warn("Could not load gallery.json", e);
      return;
    }

    const allPhotos = [];
    (gallery?.categories || []).forEach(cat => {
      (cat?.photos || []).forEach(p => allPhotos.push(p));
    });

    const fallbackPhotos = (gallery?.categories?.[0]?.photos || []);
    const bmap = buildBasenameMap(allPhotos.length ? allPhotos : fallbackPhotos);

    let lines = [];
    try {
      lines = await readLines("featured.txt");
    } catch (e) {
      console.warn("featured.txt missing; falling back to first gallery photos");
      lines = (fallbackPhotos.map(p => p?.src)).filter(Boolean);
    }

    const picks = [];
    lines.forEach(line => {
      if (line.includes("/")) {
        picks.push(toPhotoObj(line));
      } else {
        const resolved = bmap.get(line.toLowerCase());
        if (resolved) picks.push(toPhotoObj(resolved));
        else console.warn("featured.txt item not found in gallery.json:", line);
      }
    });

    const list = picks.filter(Boolean);
    if (!list.length) return;

    track.innerHTML = "";
    list.forEach((p) => {
      const a = document.createElement("a");
      a.className = "showcase-tile";
      a.href = "portfolio.html";

      const img = document.createElement("img");
      img.loading = "lazy";
      img.decoding = "async";
      img.src = p.thumb || p.src;
      img.alt = p.alt || "Kram Studios";

      a.appendChild(img);
      track.appendChild(a);
    });
  })();
</script>

<script src="assets/js/main.js"></script>
<script src="assets/js/hero-carousel.js"></script>
</body>
</html>
